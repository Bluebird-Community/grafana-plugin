{"version":3,"sources":["../../../../src/datasources/fault-ds/mapping/RestrictionMapping.js"],"names":["_","ComparatorMapping","ClauseMapping","AttributeMapping","ValueMapping","UI","API","RestrictionMapping","uiSegmentSrv","apiRestriction","NestedRestriction","getUiQuery","uiRestriction","Restriction","RestrictionDTO","getUiAttribute","attribute","getUiComparator","comparator","getUiValue","value","apiNestedRestriction","self","uiQuery","Query","uiClauses","map","clauses","getUiClause","clause","each","addClause","uiClause","getApiNestedRestriction","restrictionDTO","asRestrictionDTO","getApiAttribute","getApiComparator","getApiValue","nestedRestriction","apiClause","getApiClause","withClause"],"mappings":";;;;;;;;;;;;;;;AAAOA,a;;AAECC,6B,sBAAAA,iB;;AACAC,yB,kBAAAA,a;;AACAC,4B,qBAAAA,gB;;AACAC,wB,iBAAAA,Y;;AACAC,c,OAAAA,E;;AACAC,e,YAAAA,G;;;;;;;;;;;;;;;;;;;;;0CAEKC,kB;AAET,4CAAYC,YAAZ,EAA0B;AAAA;;AACtB,yBAAKA,YAAL,GAAoBA,YAApB;AACH;;;;qDAEgBC,c,EAAgB;AAC7B,4BAAIA,0BAA0BH,IAAII,iBAAlC,EAAqD;AACjD,mCAAO,KAAKC,UAAL,CAAgBF,cAAhB,CAAP;AACH,yBAFD,MAEO;AACH,gCAAIG,gBAAgB,IAAIP,GAAGQ,WAAP,CAChB,KAAKL,YADW,EAEhB,IAAIH,GAAGS,cAAP,CACI,IAAIX,gBAAJ,GAAuBY,cAAvB,CAAsCN,eAAeO,SAArD,CADJ,EAEI,IAAIf,iBAAJ,GAAwBgB,eAAxB,CAAwCR,eAAeS,UAAvD,CAFJ,EAGI,IAAId,YAAJ,GAAmBe,UAAnB,CAA8BV,eAAeO,SAA7C,EAAwDP,eAAeW,KAAvE,CAHJ,CAFgB,CAApB;AAQA,mCAAOR,aAAP;AACH;AACJ;;;+CAEUS,oB,EAAsB;AAC7B,4BAAIC,OAAO,IAAX;AACA,4BAAIC,UAAU,IAAIlB,GAAGmB,KAAP,CAAa,KAAKhB,YAAlB,CAAd;AACA,4BAAIiB,YAAYzB,EAAE0B,GAAF,CAAML,qBAAqBM,OAA3B,EAAoC,kBAAU;AAC1D,mCAAO,IAAIzB,aAAJ,CAAkBoB,KAAKd,YAAvB,EAAqCoB,WAArC,CAAiDC,MAAjD,CAAP;AACH,yBAFe,CAAhB;AAGA7B,0BAAE8B,IAAF,CAAOL,SAAP,EAAkB,oBAAY;AAC1BF,oCAAQQ,SAAR,CAAkBC,QAAlB;AACH,yBAFD;AAGA,+BAAOT,OAAP;AACH;;;sDAEiBX,a,EAAe;AAC7B,4BAAIA,yBAAyBP,GAAGmB,KAAhC,EAAuC;AACnC,mCAAO,KAAKS,uBAAL,CAA6BrB,aAA7B,CAAP;AACH,yBAFD,MAEO;AACH,gCAAMsB,iBAAiBtB,cAAcuB,gBAAd,EAAvB;AACA,gCAAID,mBAAmB,IAAvB,EAA6B;AACzB,oCAAMlB,YAAY,IAAIb,gBAAJ,GAAuBiC,eAAvB,CAAuCF,eAAelB,SAAtD,CAAlB;AACA,oCAAME,aAAa,IAAIjB,iBAAJ,GAAwBoC,gBAAxB,CAAyCH,eAAehB,UAAxD,CAAnB;AACA,oCAAME,QAAQ,IAAIhB,YAAJ,GAAmBkC,WAAnB,CAA+BJ,eAAelB,SAA9C,EAAyDkB,eAAed,KAAxE,CAAd;AACA,uCAAO,IAAId,IAAIO,WAAR,CAAoBG,SAApB,EAA+BE,UAA/B,EAA2CE,KAA3C,CAAP;AACH;AACD,mCAAO,IAAP;AACH;AACJ;;;4DAEuBG,O,EAAS;AAC7B,4BAAMD,OAAO,IAAb;AACA,4BAAMiB,oBAAoB,IAAIjC,IAAII,iBAAR,EAA1B;AACAV,0BAAE8B,IAAF,CAAOP,QAAQI,OAAf,EAAwB,oBAAY;AAChC,gCAAMa,YAAY,IAAItC,aAAJ,CAAkBoB,KAAKd,YAAvB,EAAqCiC,YAArC,CAAkDT,QAAlD,CAAlB;AACA,gCAAIQ,cAAc,IAAlB,EAAwB;AACpBD,kDAAkBG,UAAlB,CAA6BF,SAA7B;AACH;AACJ,yBALD;AAMA,+BAAOD,iBAAP;AACH","file":"RestrictionMapping.js","sourcesContent":["import _ from 'lodash';\n\nimport {ComparatorMapping} from './ComparatorMapping'\nimport {ClauseMapping} from './ClauseMapping'\nimport {AttributeMapping} from './AttributeMapping';\nimport {ValueMapping} from './ValueMapping';\nimport {UI} from '../UI'\nimport {API} from '../../../opennms';\n\nexport class RestrictionMapping {\n\n    constructor(uiSegmentSrv) {\n        this.uiSegmentSrv = uiSegmentSrv;\n    }\n\n    getUiRestriction(apiRestriction) {\n        if (apiRestriction instanceof API.NestedRestriction) {\n            return this.getUiQuery(apiRestriction);\n        } else {\n            var uiRestriction = new UI.Restriction(\n                this.uiSegmentSrv,\n                new UI.RestrictionDTO(\n                    new AttributeMapping().getUiAttribute(apiRestriction.attribute),\n                    new ComparatorMapping().getUiComparator(apiRestriction.comparator),\n                    new ValueMapping().getUiValue(apiRestriction.attribute, apiRestriction.value)\n                )\n            );\n            return uiRestriction\n        }\n    }\n\n    getUiQuery(apiNestedRestriction) {\n        let self = this;\n        let uiQuery = new UI.Query(this.uiSegmentSrv);\n        var uiClauses = _.map(apiNestedRestriction.clauses, clause => {\n            return new ClauseMapping(self.uiSegmentSrv).getUiClause(clause);\n        });\n        _.each(uiClauses, uiClause => {\n            uiQuery.addClause(uiClause);\n        });\n        return uiQuery;\n    }\n\n    getApiRestriction(uiRestriction) {\n        if (uiRestriction instanceof UI.Query) {\n            return this.getApiNestedRestriction(uiRestriction);\n        } else {\n            const restrictionDTO = uiRestriction.asRestrictionDTO();\n            if (restrictionDTO !== null) {\n                const attribute = new AttributeMapping().getApiAttribute(restrictionDTO.attribute);\n                const comparator = new ComparatorMapping().getApiComparator(restrictionDTO.comparator);\n                const value = new ValueMapping().getApiValue(restrictionDTO.attribute, restrictionDTO.value);\n                return new API.Restriction(attribute, comparator, value);\n            }\n            return null;\n        }\n    }\n\n    getApiNestedRestriction(uiQuery) {\n        const self = this;\n        const nestedRestriction = new API.NestedRestriction();\n        _.each(uiQuery.clauses, uiClause => {\n            const apiClause = new ClauseMapping(self.uiSegmentSrv).getApiClause(uiClause);\n            if (apiClause !== null) {\n                nestedRestriction.withClause(apiClause);\n            }\n        });\n        return nestedRestriction;\n    }\n}"]}