{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"lodash\"","webpack:///./lib/utils.ts","webpack:///./components/config.ts","webpack:///./module.ts","webpack:///external \"@grafana/runtime\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__WEBPACK_EXTERNAL_MODULE__0__","cssInitialized","initializeCss","dark","light","assignModelProperties","target","source","defaults","undefined","selectOptionsForCurrentValue","variable","y","option","selected","options","length","isArray","current","push","setOptionAsCurrent","cloneDeep","text","join","emitChangeEvents","dashboardSrv","templateSrv","initLock","Promise","resolve","getVariables","dashboard","variables","promises","forEach","v","updateOptions","setGlobalVariable","id","all","then","templateVariableValueUpdated","startRefresh","variableUpdated","setOptionFromUrl","urlValue","promise","refresh","find","op","defaultText","defaultValue","reduce","acc","item","multi","castArray","setValue","validateVariableSelectionState","firstOption","val","map","variableRegex","variableRegexExec","variableString","lastIndex","exec","containsVariable","args","variableName","isString","slice","matches","match","isMatchingVariable","varMatch","indexOf","isFirst","index","array","processSelectionVariables","input","mapped","dropUnresolved","dropAll","startsWith","endsWith","substring","split","trim","some","processSelectionVariable","concat","filter","OpenNMSGlob","expr","escapeRegExp","replace","includes","globExpressions","swap","thisArray","colIndex1","colIndex2","tmp","swapColumns","rows","Error","SimpleOpenNMSRequest","backendSrv","url","timeout","withCredentials","searchLimit","this","basicAuth","headers","Authorization","datasourceRequest","doOpenNMSRequest","method","params","limit","response","data","count","totalCount","results","each","location","nodeLocation","toString","exist","expandable","filterRule","node","nodeCriteria","foreignId","foreignSource","label","OpenNMSHelmAppConfigCtrl","appModel","jsonData","actions","actionIndex","splice","templateUrl","__WEBPACK_EXTERNAL_MODULE__9__"],"mappings":"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","file":"module.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 50);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","import _ from 'lodash';\n\nimport { loadPluginCss } from '@grafana/runtime';\n\nlet cssInitialized = false;\nexport function initializeCss() {\n  if (!cssInitialized) {\n    cssInitialized = true;\n    loadPluginCss({\n      dark: 'plugins/opennms-helm-app/styles/dark.css',\n      light: 'plugins/opennms-helm-app/styles/light.css',\n    });\n  }\n}\n\nexport function assignModelProperties(target, source, defaults = {}) {\n  for (const key in defaults) {\n    if (!defaults.hasOwnProperty(key)) {\n      continue;\n    }\n\n    target[key] = source[key] === undefined ? defaults[key] : source[key];\n  }\n}\n\nexport function selectOptionsForCurrentValue(variable) {\n  let i, y, value, option;\n  const selected = [] as any[];\n\n  for (i = 0; i < variable.options.length; i++) {\n    option = variable.options[i];\n    option.selected = false;\n    if (_.isArray(variable.current.value)) {\n      for (y = 0; y < variable.current.value.length; y++) {\n        value = variable.current.value[y];\n        if (option.value === value) {\n          option.selected = true;\n          selected.push(option);\n        }\n      }\n    } else if (option.value === variable.current.value) {\n      option.selected = true;\n      selected.push(option);\n    }\n  }\n\n  return selected;\n}\n\nexport function setOptionAsCurrent(variable, option) {\n  variable.current = _.cloneDeep(option || {});\n\n  if (_.isArray(variable.current.text) && variable.current.text.length > 0) {\n    variable.current.text = variable.current.text.join(' + ');\n  } else if (_.isArray(variable.current.value) && variable.current.value[0] !== '$__all') {\n    variable.current.text = variable.current.value.join(' + ');\n  }\n\n  selectOptionsForCurrentValue(variable);\n  return variableUpdated(variable);\n}\n\nexport function variableUpdated(variable, emitChangeEvents = false) {\n  const dashboardSrv = variable.dashboardSrv;\n  const templateSrv = variable.templateSrv;\n\n  // if there is a variable lock ignore cascading update because we are in a boot up scenario\n  if (variable.initLock) {\n    return Promise.resolve();\n  }\n\n  const getVariables = templateSrv.getVariables.bind(templateSrv) || dashboardSrv.dashboard.getVariables.bind(dashboardSrv.dashboard);\n  const variables = getVariables();\n  let promises = [] as Array<Promise<any>>;\n\n  // in theory we should create an efficient sub-list of variables to update, but for now just do them all YOLO\n  variables.forEach(v => promises.push(v.updateOptions()));\n\n  templateSrv.setGlobalVariable(variable.id, variable.current);\n\n  return Promise.all(promises).then(() => {\n    if (emitChangeEvents) {\n      dashboardSrv.dashboard.templateVariableValueUpdated();\n      dashboardSrv.dashboard.startRefresh();\n    }\n  });\n}\n\n\nexport function setOptionFromUrl(variable: any, urlValue: any) {\n  let promise = Promise.resolve();\n\n  if (variable.refresh) {\n    promise = variable.updateOptions();\n  }\n\n  return promise.then(() => {\n    // Simple case. Value in url matches existing options text or value.\n    let option = _.find(variable.options, op => {\n      return op.text === urlValue || op.value === urlValue;\n    });\n\n    // No luck either it is array or value does not exist in the variables options.\n    if (!option) {\n      let defaultText = urlValue;\n      const defaultValue = urlValue;\n\n      if (_.isArray(urlValue)) {\n        // Multiple values in the url. We construct text as a list of texts from all matched options.\n        defaultText = urlValue.reduce((acc, item) => {\n          const t = _.find(variable.options, { value: item });\n          if (t) {\n            acc.push(t.text);\n          } else {\n            acc.push(item);\n          }\n\n          return acc;\n        }, []);\n      }\n\n      // It is possible that we did not match the value to any existing option. In that case the url value will be\n      // used anyway for both text and value.\n      option = { text: defaultText, value: defaultValue };\n    }\n\n    if (variable.multi) {\n      // In case variable is multiple choice, we cast to array to preserve the same behaviour as when selecting\n      // the option directly, which will return even single value in an array.\n      option = { text: _.castArray(option.text), value: _.castArray(option.value) };\n    }\n\n    return variable.setValue(option);\n  });\n}\n\nexport function validateVariableSelectionState(variable: any, defaultValue?: any) {\n  if (!variable.current) {\n    variable.current = {};\n  }\n\n  if (_.isArray(variable.current.value)) {\n    let selected = selectOptionsForCurrentValue(variable);\n\n    // if none pick first\n    if (selected.length === 0) {\n      let firstOption = variable.options[0];\n      if (firstOption) {\n        return variable.setValue(firstOption);\n      }\n      return Promise.resolve();\n    } else {\n      let val = {\n        value: _.map(selected, val => {\n          return val.value;\n        }),\n        text: _.map(selected, val => {\n          return val.text;\n        }),\n      };\n      return variable.setValue(val);\n    }\n  } else {\n    let option = undefined;\n\n    // 1. find the current value\n    option = _.find(variable.options, {\n      text: variable.current.text,\n    });\n    if (option) {\n      return variable.setValue(option);\n    }\n\n    // 2. find the default value\n    if (defaultValue) {\n      option = _.find(variable.options, {\n        text: defaultValue,\n      });\n      if (option) {\n        return variable.setValue(option);\n      }\n    }\n\n    // 3. use the first value\n    if (variable.options) {\n      return variable.setValue(variable.options[0]);\n    }\n\n    // 4... give up\n    return Promise.resolve();\n  }\n}\n\nexport const variableRegex = /\\$(\\w+)|\\[\\[([\\s\\S]+?)(?::(\\w+))?\\]\\]|\\${(\\w+)(?:\\.([^:^}]+))?(?::(\\w+))?}/g;\n\nexport const variableRegexExec = (variableString) => {\n  variableRegex.lastIndex = 0;\n  return variableRegex.exec(variableString);\n};\n\nexport function containsVariable(...args) {\n  const variableName = args[args.length - 1];\n  args[0] = _.isString(args[0]) ? args[0] : Object['values'](args[0]).join(' ');\n  const variableString = args.slice(0, -1).join(' ');\n  const matches = variableString.match(variableRegex);\n  const isMatchingVariable =\n    matches !== null\n      ? matches.find(match => {\n          const varMatch = variableRegexExec(match);\n          return varMatch !== null && varMatch.indexOf(variableName) > -1;\n        })\n      : false;\n\n  return !!isMatchingVariable;\n}\n\n/**\n * Converts an input string into a string array of selected values.\n *\n * The input string may be the value of a multi-selection template variable. In this case the input string is\n * delimited by curly braces that enclose a comma separated list of values.\n *\n * The dropUnresolved parameter determines if an empty array is returned if the input starts with '$'.\n * The dropAll parameter determines if an empty array is returned if the input is \"all\".\n */\n export function processSelectionVariable(input: string, dropUnresolved: boolean, dropAll: boolean): string[] {\n  if (input) {\n      if (input.startsWith('{') && input.endsWith('}')) {\n          const args = input.substring(1, input.length - 1).split(',').map(s => s.trim())\n          if (dropAll && args.some(s => s === 'all')) {\n              return []\n          } else {\n              return args\n          }\n      } else if (dropUnresolved && input.startsWith('$')) {\n          return [];\n      } else if (dropAll && input === 'all') {\n          return []\n      } else {\n          return [input]\n      }\n  } else {\n      return []\n  }\n}\n\n/** Checks if the given index is the first index of the given t. */\nexport function isFirst<T>(t: T, index: number, array: T[]) {\n  return array.indexOf(t) === index;\n}\n\n/**\n * Converts multiple (possibly multi-selection) inputs into a string array of all contained selections.\n *\n * Unresolved template variables (detected by a leading '$' sign) are ignored. This allows to remove template variables\n * from a dashboard without having to adjust queries that use them.\n *\n * An empty array is returned if \"all\" would be included in the selections. Duplicates are removed.\n */\nexport function processSelectionVariables(input?: string[]): string[] {\n  if (input) {\n      const mapped = input.map(i => processSelectionVariable(i, true, false))\n      if (mapped.some(m => m.some(s => s === 'all'))) {\n          return []\n      } else {\n          return ([] as string[]).concat(...mapped).filter(isFirst)\n      }\n  } else {\n      return []\n  }\n}\n\n\nexport class OpenNMSGlob {\n  private static globExpressions: string[] = ['*', '|'];\n\n  static getGlobAsRegexPattern(expr: string) {\n    return _.escapeRegExp(expr).replace(/\\\\\\*/ig, '.*').replace(/\\\\\\|/ig, '|');\n  }\n\n  /**\n   * Check if expression contains allowed glob characters\n   * @param expr expression\n   * @returns true if expression contains allowed glob characters ('*', '|')\n   */\n  static hasGlob(expr: string): boolean {\n    return _.some([...expr], (char) => {\n      return _.includes(OpenNMSGlob.globExpressions, char);\n    });\n  }\n}\n\n/**\n * Swap items in an array\n * @param thisArray \n */\nexport function swap(thisArray: any[], colIndex1: number, colIndex2: number): any[] {\n  const tmp = thisArray[colIndex1];\n  thisArray[colIndex1] = thisArray[colIndex2];\n  thisArray[colIndex2] = tmp;\n  return thisArray;\n}\n\n/**\n * Swap table rows column values\n * @param colIndex1 \n * @param colIndex2 \n */\nexport function swapColumns(rows: any[][], colIndex1: number, colIndex2: number): any[][] {\n  if (rows && rows.length > 0 && colIndex1 >= 0 && colIndex2 >= 0) {\n    for (var i = 0; i < rows.length; i++) {\n      if (colIndex1 >= rows[i].length || colIndex2 >= rows[i].length) {\n        throw new Error('Index out of bounds');\n      }\n      rows[i] = swap(rows[i], colIndex1, colIndex2);\n    }\n  }\n  return rows;\n\n}\n\nexport class SimpleOpenNMSRequest {\n  backendSrv: any;\n  timeout: number = 10000;\n  url?: string;\n  withCredentials: boolean = false;\n  basicAuth?: string;\n  searchLimit = 25;\n\n  constructor(backendSrv, url) {\n    this.backendSrv = backendSrv;\n    this.url = url;\n  }\n\n  doOpenNMSRequest(options: any): Promise<any> {\n\n    if (this.basicAuth || this.withCredentials) {\n      options.withCredentials = true;\n    }\n    if (this.basicAuth) {\n      options.headers = options.headers || {};\n      options.headers.Authorization = this.basicAuth;\n    }\n\n    options.url = this.url + options.url;\n    if (this.timeout) {\n      options.timeout = this.timeout;\n    }\n\n    return this.backendSrv.datasourceRequest(options);\n  }\n\n  getLocations(searchLimit = 0){\n    return this.doOpenNMSRequest({\n      url: '/rest/monitoringLocations',\n      method: 'GET',\n      params: {\n        limit: searchLimit       \n      }\n    })\n    .then(function(response){\n      if (response.data.count > response.data.totalCount) {\n        console.warn(\"Filter matches \" + response.data.totalCount + \" records, but only \" + response.data.count + \" will be used.\");\n      }\n      var results = [] as any[];\n      _.each(response.data.location, function (location) {\n        let nodeLocation = location['location-name'] ? location['location-name'].toString() : null;\n        let exist = _.find(results, (o)=> o.text === nodeLocation);\n        if(nodeLocation && !exist){\n          results.push({text: nodeLocation, value: nodeLocation, expandable: true});\n        }\n      });\n      return results;\n    });\n  }\n\n  getNodesByFilter(filter: string){\n    return this.doOpenNMSRequest({\n      url: '/rest/nodes',\n      method: 'GET',\n      params: {\n        filterRule: filter,\n        limit: 0\n      }\n    }).then(function (response) {\n      if (response.data.count > response.data.totalCount) {\n        console.warn(\"Filter matches \" + response.data.totalCount + \" records, but only \" + response.data.count + \" will be used.\");\n      }\n      var results = [] as any[];\n      _.each(response.data.node, function (node) {\n        var nodeCriteria = node.id.toString();\n        if (node.foreignId !== null && node.foreignSource !== null) {\n          nodeCriteria = node.foreignSource + \":\" + node.foreignId;\n        }\n        results.push({text: node.label, value: nodeCriteria, expandable: true});\n      });\n      return results;\n    });\n  }\n}\n\n","export class OpenNMSHelmAppConfigCtrl {\n  appModel: any;\n  data: any;\n  static templateUrl: string;\n\n  /** @ngInject */\n  constructor() {\n    if (!this.appModel.jsonData) {\n      this.appModel.jsonData = {};\n    }\n    if (!this.appModel.jsonData.actions) {\n      this.appModel.jsonData.actions = [];\n    }\n    this.data = this.appModel.jsonData;\n  }\n\n  addAction() {\n    this.data.actions.push({ url: '' });\n  }\n\n  removeAction(actionIndex: number) {\n    if (this.data.actions[actionIndex]) {\n      console.info('removing action ' + this.data.actions[actionIndex].label + '(' + actionIndex + ')');\n      this.data.actions.splice(actionIndex, 1);\n    } else {\n      console.warn('no action at index ' + actionIndex);\n    }\n  }\n}\n\nOpenNMSHelmAppConfigCtrl.templateUrl = 'public/plugins/opennms-helm-app/components/config.html';\n","import { OpenNMSHelmAppConfigCtrl } from './components/config';\n\nimport { initializeCss } from 'lib/utils';\n\ninitializeCss();\n\nexport { OpenNMSHelmAppConfigCtrl as ConfigCtrl };\n","module.exports = __WEBPACK_EXTERNAL_MODULE__9__;"],"sourceRoot":""}