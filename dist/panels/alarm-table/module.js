define(["@grafana/data","react","@grafana/ui","@emotion/css","@grafana/runtime","lodash"],((e,t,n,l,a,r)=>(()=>{"use strict";var o={644:e=>{e.exports=l},305:t=>{t.exports=e},477:e=>{e.exports=a},388:e=>{e.exports=n},980:e=>{e.exports=r},650:e=>{e.exports=t}},i={};function c(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return o[e](n,n.exports,c),n.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{c.r(s),c.d(s,{plugin:()=>G});var e=c(305),t=c(650),n=c.n(t),l=c(388),a=c(644);const r=({state:e,actions:t})=>{let r=[{label:"Details",action:t.details},{type:"divider",label:""},{label:"Acknowledge",action:t.acknowledge},{label:"Escalate",action:t.escalate},{label:"Clear",action:t.clear}];e.indexes.filter((e=>!0===e)).length>1&&(r=r.splice(2,r.length));const o=(0,l.useStyles2)((e=>({divider:(0,a.css)({height:1,backgroundColor:e.colors.border.weak,margin:e.spacing(.5,0)})})));return n().createElement(l.Menu,null,r.map(((e,t)=>{let a=n().createElement(l.MenuItem,{label:e.label,key:t,onClick:e.action});return"divider"===e.type&&(a=n().createElement("div",{className:o.divider})),a})))},o=({alarm:e})=>n().createElement("div",null,n().createElement("pre",null,JSON.stringify(e,null,2)));var i=c(477);function u(e,t,n,l,a,r,o){try{var i=e[r](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(l,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(l,a){var r=e.apply(t,n);function o(e){u(r,l,a,o,i,"next",e)}function i(e){u(r,l,a,o,i,"throw",e)}o(void 0)}))}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){m(e,t,n[t])}))}return e}function f(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n.push.apply(n,l)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const p=({alarm:e,client:a})=>{const[r,o]=(0,t.useState)(null==e?void 0:e.sticky),[c,s]=(0,t.useState)(null==e?void 0:e.journal),[u,m]=(0,t.useState)(!1);(0,t.useEffect)((()=>{o(null==e?void 0:e.sticky)}),[null==e?void 0:e.sticky]),(0,t.useEffect)((()=>{s(null==e?void 0:e.journal)}),[null==e?void 0:e.journal]);const p=(b=d((function*(){var t;m(!0),yield null==a?void 0:a.saveSticky(null==e?void 0:e.id,null==r?void 0:r.body,null===i.config||void 0===i.config||null===(t=i.config.bootData)||void 0===t?void 0:t.user.id),m(!1)})),function(){return b.apply(this,arguments)});var b;const y=function(){var t=d((function*(){m(!0),yield null==a?void 0:a.deleteSticky(null==e?void 0:e.id),m(!1)}));return function(){return t.apply(this,arguments)}}(),g=function(){var t=d((function*(){var t;m(!0),yield null==a?void 0:a.saveJournal(null==e?void 0:e.id,null==c?void 0:c.body,null===i.config||void 0===i.config||null===(t=i.config.bootData)||void 0===t?void 0:t.user.id),m(!1)}));return function(){return t.apply(this,arguments)}}(),h=function(){var t=d((function*(){m(!0),yield null==a?void 0:a.deleteJournal(null==e?void 0:e.id),m(!1)}));return function(){return t.apply(this,arguments)}}();return n().createElement("div",null,n().createElement("style",null,"\n                    .sticky-memo {\n                        display:flex;\n                    }\n                    .memo-header {\n                        margin-top:24px;\n                    }\n                    .memo-wrapper {\n                        margin-bottom:24px;\n                    }\n                    "),n().createElement("div",{className:"memo-wrapper"},n().createElement("h2",{className:"memo-header"},"Sticky Memo"),n().createElement(l.TextArea,{value:null==r?void 0:r.body,onChange:t=>{o(f(v({},null==e?void 0:e.sticky),{body:t.target.value}))}}),n().createElement(l.HorizontalGroup,{className:"sticky-memo"},u,n().createElement(l.Button,{onClick:p},n().createElement("i",{className:"fa fa-plus"})," Save"),n().createElement(l.Button,{variant:"destructive",onClick:y},n().createElement("i",{className:"fa fa-minus"})," Delete"))),n().createElement("div",{className:"memo-wrapper"},n().createElement("h2",{className:"memo-header"},"Journal Memo"),n().createElement(l.TextArea,{value:null==c?void 0:c.body,onChange:t=>{s(f(v({},null==e?void 0:e.journal),{body:t.target.value}))}}),n().createElement(l.HorizontalGroup,{className:"sticky-memo"},u,n().createElement(l.Button,{onClick:g},n().createElement("i",{className:"fa fa-plus"})," Save"),n().createElement(l.Button,{variant:"destructive",onClick:h},n().createElement("i",{className:"fa fa-minus"})," Delete"))))},b=({alarm:e})=>{var t,l,a,r;return n().createElement("div",null,n().createElement("style",null,"\n                .alarm-details-table tr{\n                        height:32px;\n                        padding-left:12px;\n                }\n                .alarm-details-table tr:nth-child(2n+1) {\n                    background-color:#1c1f23;\n                }\n                .alarm-details-table th {\n                    padding-left:12px;\n                    padding-right:12px;\n                    white-space: nowrap;\n                }\n                .alarm-details-table td {\n                    padding-top:12px;\n                    padding-bottom:12px;\n                }\n                "),n().createElement("table",{className:"alarm-details-table"},n().createElement("tr",null,n().createElement("th",null,"UEI"),n().createElement("td",{className:"wrap"},null==e?void 0:e.uei)),n().createElement("tr",null,n().createElement("th",null,"Severity"),n().createElement("td",null,null==e||null===(t=e.severity)||void 0===t?void 0:t.label)),n().createElement("tr",null,n().createElement("th",null,"Last Event Time"),n().createElement("td",null,null==e||null===(l=e.lastEvent)||void 0===l||null===(a=l.time)||void 0===a?void 0:a.toString())),n().createElement("tr",null,n().createElement("th",null,"First Event Time"),n().createElement("td",null,null==e||null===(r=e.firstEventTime)||void 0===r?void 0:r.toString())),n().createElement("tr",null,n().createElement("th",null,"Log Message"),n().createElement("td",{dangerouslySetInnerHTML:{__html:(null==e?void 0:e.logMessage)||""}})),n().createElement("tr",null,n().createElement("th",null,"Description"),n().createElement("td",{dangerouslySetInnerHTML:{__html:(null==e?void 0:e.description)||""}})),n().createElement("tr",null,n().createElement("th",null,"Count"),n().createElement("td",null,null==e?void 0:e.count)),n().createElement("tr",null,n().createElement("th",null,"Reduction Key"),n().createElement("td",null,null==e?void 0:e.reductionKey)),(null==e?void 0:e.managedObjectInstance)&&n().createElement("tr",null,n().createElement("th",null,"Managed Object Instance"),n().createElement("td",null,null==e?void 0:e.managedObjectInstance)),(null==e?void 0:e.managedObjectType)&&n().createElement("tr",null,n().createElement("th",null,"Managed Object Type"),n().createElement("td",null,null==e?void 0:e.managedObjectType))))},y=({tab:e,alarm:t,client:l})=>n().createElement(n().Fragment,null,0===e&&n().createElement(b,{alarm:t}),1===e&&n().createElement(p,{alarm:t,client:l}),2===e&&n().createElement(o,{alarm:t})),g=()=>n().createElement("style",null,'\n                        .font-size-0 {\n                            font-size:80%;\n                        }\n                        .font-size-1 {\n                            font-size:90%;\n                        }\n                        .font-size-2 {\n                            font-size:100%;\n                        }\n                        .font-size-3 {\n                            font-size:110%;\n                        }\n                        .font-size-4 {\n                            font-size:120%;\n                        }\n                        .font-size-5 {\n                            font-size:130%;\n                        }\n                        .font-size-6 {\n                            font-size:140%;\n                        }\n                        .font-size-7 {\n                            font-size:150%;\n                        }\n                        .font-size-8 {\n                            font-size:160%;\n                        }\n                        .font-size-9 {\n                            font-size:180%;\n                        }\n                        .font-size-10 {\n                            font-size:200%;\n                        }\n                        .font-size-11 {\n                            font-size:220%;\n                        }\n                        .font-size-12 {\n                            font-size:250%;\n                        }\n                        .no-scroll .track-horizontal{\n                            display:none;\n                        }\n                        .alarm-query {\n                            height:100%;\n                        }\n                        .non-alarm-query {\n                            height:100%;\n                            display:flex;\n                            align-items:center;\n                            justify-content:center;\n                        }\n                        div[role="row"] {\n                            border:1px solid transparent;\n                            padding-bottom:1px;\n                        }\n                        .table-body div[role="row"]:hover {\n                            background-color:rgb(1, 33, 137);\n                        }\n                        .table-body div[role="row"]:last-child {\n                            border-bottom:1px solid transparent;\n                        }\n                        .table-body div[role="row"]:last-child {\n                            border-bottom:1px solid transparent;\n                        }\n\n                        .table-body div[role="row"].select-start {\n                            border-top:1px dashed white;\n                            border-right:1px dashed white;\n                            border-left:1px dashed white;\n                        }\n                        .table-body div[role="row"].select-continue {\n                            border-right:1px dashed white;\n                            border-left:1px dashed white;\n                        }\n                        .table-body div[role="row"].select-end {\n                            border-bottom:1px dashed white;\n                            border-right:1px dashed white;\n                            border-left:1px dashed white;\n                        }\n \n                    ');var h=c(980);const E=(e,t)=>{var n;return null===(n=e.find((e=>"ID"===e.name)))||void 0===n?void 0:n.values.get(t)};function x(e,t,n,l,a,r,o){try{var i=e[r](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(l,a)}function O(e){return function(){var t=this,n=arguments;return new Promise((function(l,a){var r=e.apply(t,n);function o(e){x(r,l,a,o,i,"next",e)}function i(e){x(r,l,a,o,i,"throw",e)}o(void 0)}))}}const w=(e,n,l,a)=>{const[r,o]=(0,t.useState)(!1),[c,s]=(0,t.useState)();(0,t.useEffect)((()=>{var e;(e=O((function*(){var e;s(null===(e=yield(0,i.getBackendSrv)().get("/api/users"))||void 0===e?void 0:e[0])})),function(){return e.apply(this,arguments)})()}),[]);const u=(d=O((function*(t){for(let l=0;l<e.length;l++)if(e[l]){const e=E(n,l);yield t(e,null==c?void 0:c.id)}})),function(e){return d.apply(this,arguments)});var d;const m=function(){var e=O((function*(){yield u(function(){var e=O((function*(e,t){yield null==a?void 0:a.doClear(e,null==c?void 0:c.id)}));return function(t,n){return e.apply(this,arguments)}}()),l()}));return function(){return e.apply(this,arguments)}}(),v=function(){var e=O((function*(){yield u(function(){var e=O((function*(e,t){yield null==a?void 0:a.doEscalate(e,null==c?void 0:c.id)}));return function(t,n){return e.apply(this,arguments)}}()),l()}));return function(){return e.apply(this,arguments)}}(),f=function(){var e=O((function*(){yield u(function(){var e=O((function*(e,t){yield null==a?void 0:a.doAck(e,null==c?void 0:c.id)}));return function(t,n){return e.apply(this,arguments)}}()),l()}));return function(){return e.apply(this,arguments)}}();return{actions:{clear:m,details:()=>{l(),o(!0)},escalate:v,acknowledge:f},detailsModal:r,setDetailsModal:o}},T=[["#999000","#eee000","#86b15b","#fccc3b","#ee901c","#e3692f","#db4345"],["#999000","#999","#360","#fc0","#f90","#f30","#c00"],["#614765","#ccc","#00b48b","#00d3c9","#ffce56","#ff9033","#ff3b50"],["#999000","#999","#a1cc72","#6ec5c6","#f9df6c","#dda35c"],["#a44ae6","#5dc93b","#ccc","#76b7f9","#fffd54","#f4b54b","#eb3223"]];function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const P=e=>{const[n,l]=(0,t.useState)({x:0,y:0}),[a,r]=(0,t.useState)(!1),o=(0,t.useRef)(null);return(0,t.useEffect)((()=>{var t;(()=>{var e;const t=null===(e=o.current)||void 0===e?void 0:e.querySelector('div[role="rowgroup"] + div');null==t||t.classList.add("table-body")})();const n=null===(t=o.current)||void 0===t?void 0:t.querySelectorAll('.table-body div[role="row"]'),a=t=>(t=>{const n=t.currentTarget.getAttribute("data-rowindex");null!==n&&(null==n?void 0:n.length)>0&&e(parseInt(n,10),t,!1)})(t),i=t=>(t=>{const n=t.currentTarget.getAttribute("data-rowindex");null!==n&&(null==n?void 0:n.length)>0&&((t,n)=>{n.preventDefault(),e(t,n,!0),l({x:n.x,y:n.y}),r((()=>!0))})(parseInt(n,10),t)})(t);return null==n||n.forEach(((e,t)=>{e.setAttribute("data-rowindex",""+t),e.addEventListener("click",a),e.addEventListener("contextmenu",i)})),()=>{n&&n.length>0&&n.forEach((e=>{e.removeEventListener("click",a),e.removeEventListener("contextmenu",i)}))}}),[o,n,a,e]),{table:o,menu:n,menuOpen:a,setMenu:l,setMenuOpen:r}};function j(e,t,n,l,a,r,o){try{var i=e[r](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(l,a)}const C=e=>{const[n,l]=(0,t.useState)();return(0,t.useEffect)((()=>{const t=(n=function*(){const t=(0,i.getDataSourceSrv)(),n=yield t.get(e);l(n.client)},a=function(){var e=this,t=arguments;return new Promise((function(l,a){var r=n.apply(e,t);function o(e){j(r,l,a,o,i,"next",e)}function i(e){j(r,l,a,o,i,"throw",e)}o(void 0)}))},function(){return a.apply(this,arguments)});var n,a;e&&t()}),[e]),{client:n}};function k(e,t,n,l,a,r,o){try{var i=e[r](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(l,a)}const N=(e,n,l)=>{const[a,r]=(0,t.useState)(!1),[o,i]=(0,t.useState)(-1),[c,s]=(0,t.useState)();return(0,t.useEffect)((()=>{if("alarms"===(null==e?void 0:e[0].name)){r(!0);const t=E(null==e?void 0:e[0].fields,n);i(t)}else i(-1),r(!1)}),[e,n]),(0,t.useEffect)((()=>{const e=(t=function*(){const e=yield null==l?void 0:l.getAlarm(o);s(e)},n=function(){var e=this,n=arguments;return new Promise((function(l,a){var r=t.apply(e,n);function o(e){k(r,l,a,o,i,"next",e)}function i(e){k(r,l,a,o,i,"throw",e)}o(void 0)}))},function(){return n.apply(this,arguments)});var t,n;o!==(null==c?void 0:c.id)&&e()}),[null==c?void 0:c.id,o,l]),{alarm:c,alarmQuery:a,goToAlarm:()=>{(null==c?void 0:c.detailsPage)&&(window.location.href=c.detailsPage)}}},M=({values:e,onChange:t})=>{const l=(n,l)=>{const a=[...e],r=a.splice(l,1);a.splice(l-1,0,r[0]),t(a)},a=(n,l)=>{const a=[...e],r=a.splice(l,1);a.splice(l+1,0,r[0]),t(a)},r=(n,l)=>{const a=[...e];a.splice(l,1),t(a)},o=e=>" "===e||"Enter"===e;return n().createElement("div",{className:"onms-drag-list"},n().createElement("style",null,"\n                    .onms-drag-buttons {\n                        display:flex;\n                        margin-left:auto;\n                    }\n                    .onms-drag-list {\n                        max-width:360px;\n                    }\n                    .onms-drag-button {\n                        background-color:rgb(61, 113, 217);\n                        border-radius:2px;\n                        width:22px;\n                        height:22px;\n                        display:flex;\n                        align-items:center;\n                        justify-content:center;\n                        margin-right:6px;\n                        cursor:pointer;\n                    }\n                    .onms-drag-button.onms-drag-remove {\n                        background-color:rgb(239, 25, 32);\n                    }\n                    .onms-drag-wrapper{\n                        height: 40px;\n                        margin-bottom:6px;\n                        display: flex;\n                        align-items: center;\n                        border:1px solid #2f2e2e;\n                        padding:10px 15px;\n                        border-radius:2px;\n                    }\n                    "),e.map(((e,t)=>n().createElement("div",{key:t,className:"onms-drag-wrapper"},n().createElement("span",null,t+1,". "),n().createElement("span",null,e.label),n().createElement("div",{className:"onms-drag-buttons"},n().createElement("span",{className:"onms-drag-button",tabIndex:0,onKeyUp:e=>((e,t)=>{o(e.key)&&l(0,t)})(e,t),onClick:e=>l(0,t)},n().createElement("i",{className:"fa fa-arrow-up"})),n().createElement("span",{className:"onms-drag-button",tabIndex:0,onKeyUp:e=>((e,t)=>{o(e.key)&&a(0,t)})(e,t),onClick:e=>a(0,t)},n().createElement("i",{className:"fa fa-arrow-down"})),n().createElement("span",{className:"onms-drag-button onms-drag-remove",onKeyUp:e=>((e,t)=>{o(e.key)&&r(0,t)})(e,t),tabIndex:0,onClick:e=>r(0,t)},n().createElement("i",{className:"fa fa-ban"})))))))};function D(){return D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},D.apply(this,arguments)}const z=e=>{var{children:t}=e,a=function(e,t){if(null==e)return{};var n,l,a=function(e,t){if(null==e)return{};var n,l,a={},r=Object.keys(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,["children"]);return n().createElement(n().Fragment,null,n().createElement("style",null,"\n                        .onms-inline-field > label{\n                            width:160px;\n                        }\n                    "),n().createElement(l.InlineField,D({},a,{className:"onms-inline-field"}),t))},I=[{label:"80%",value:0},{label:"90%",value:1},{label:"100%",value:2},{label:"110%",value:3},{label:"120%",value:4},{label:"130%",value:5},{label:"140%",value:6},{label:"150%",value:7},{label:"160%",value:8},{label:"180%",value:9},{label:"200%",value:10},{label:"220%",value:11},{label:"250%",value:12}],A=[{label:"Default",value:0},{label:"OpenNMS",value:1},{label:"Oh My!",value:2},{label:"No, Never Mind (i)",value:3},{label:"That's Cool",value:4},{label:"Custom",value:5}],L=[{label:"Is Acknowledged",value:20},{label:"Severity",value:5},{label:"Count",value:1},{label:"Last Event Time",value:23},{label:"Location",value:8},{label:"Node Label",value:14},{label:"Log Message",value:9}];function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){q(e,t,n[t])}))}return e}const W=({onChange:e,context:a})=>{var r,o,i,c;const[s,u]=(0,t.useState)((null==a||null===(r=a.options)||void 0===r||null===(o=r.alarmTable)||void 0===o?void 0:o.alarmTableData)||{columns:L});(0,t.useEffect)((()=>{e(s)}),[s]);const d=(e,t)=>{const n=R({},s);n[e]=t,u(n)};return n().createElement("div",null,n().createElement(z,{label:"Columns"},n().createElement(l.Select,{placeholder:"Add Column",value:"",onChange:e=>{const t=[...s.columns];t.push(e),d("columns",t)},options:null==a||null===(i=a.data)||void 0===i||null===(c=i[0])||void 0===c?void 0:c.fields.map(((e,t)=>{return n=R({},e),l=null!=(l={value:t,label:e.name})?l:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n.push.apply(n,l)}return n}(Object(l)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(l,e))})),n;var n,l}))})),n().createElement(M,{values:null==s?void 0:s.columns,onChange:e=>{d("columns",e)}}))},F=({className:e,children:t})=>n().createElement("div",{className:e,style:{display:"flex",alignItems:"center",height:32,width:32}},t);function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const B=({onChange:e,context:a})=>{var r,o;const[i,c]=(0,t.useState)((null==a||null===(r=a.options)||void 0===r||null===(o=r.alarmTable)||void 0===o?void 0:o.alarmTablePaging)||{pauseRefresh:!1,scroll:!0,rowsPerPage:10,fontSize:{label:"100%",value:2}}),s=(e,t)=>{const n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){_(e,t,n[t])}))}return e}({},i);n[e]=t,c(n)};return(0,t.useEffect)((()=>{e(i)}),[i]),n().createElement("div",null,n().createElement(z,{label:"Rows per page"},n().createElement(l.Input,{type:"number",value:i.rowsPerPage,onChange:e=>s("rowsPerPage",e.currentTarget.value)})),n().createElement(z,{label:"Scroll"},n().createElement(F,null,n().createElement(l.Switch,{value:i.scroll,onChange:e=>s("scroll",!i.scroll)}))),n().createElement(z,{label:"Font size"},n().createElement(l.Select,{value:i.fontSize,options:I,onChange:e=>s("fontSize",e)})))},V=({title:e,icon:t,color:l})=>n().createElement("div",{style:{backgroundColor:l,display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",height:30,padding:"0 10px",color:"#fff",maxWidth:260}},n().createElement("style",null,"\n                i.color-bar {\n                    text-shadow: 1px 0 0 #000,-1px 0 0 #000,0 1px 0 #000,0 -1px 0 #000,.5px .5px #000,-.5px -.5px 0 #000,.5px -.5px 0 #000,-.5px .5px 0 #000;\n                }\n                .color-bar-title {\n                    background-color:#565656;\n                    padding:1px 8px;\n                    border-radius: 10px;\n                }\n                "),n().createElement("div",{className:"color-bar-title"},e),n().createElement("div",null,n().createElement("i",{className:` color-bar fa fa-${t}`}))),K=({theme:e})=>{const t=()=>{let t=0;return e&&"string"==typeof e?t=Number(e):e&&"number"==typeof e&&T[e]&&(t=e),t};return n().createElement("div",{style:{marginTop:20}},[{text:"Indeterminate",icon:"question-circle"},{text:"Cleared",icon:"check-circle"},{text:"Normal",icon:"leaf"},{text:"Warning",icon:"exclamation-triangle"},{text:"Minor",icon:"bolt"},{text:"Major",icon:"fire"},{text:"Critical",icon:"bomb"}].map(((e,l)=>n().createElement(V,{key:l,title:e.text,icon:e.icon,color:T[t()][l]}))))};function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const $=({onChange:e,alarmTable:a})=>{var r,o,i;const[c,s]=(0,t.useState)({styleWithSeverity:(null==a||null===(r=a.alarmTableAlarms)||void 0===r?void 0:r.styleWithSeverity)||{label:"Column",value:1},severityTheme:(null==a||null===(o=a.alarmTableAlarms)||void 0===o?void 0:o.severityTheme)||{label:"Default",value:0}});(0,t.useEffect)((()=>{e(c)}),[c]);const u=(e,t)=>{const n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){J(e,t,n[t])}))}return e}({},c);n[e]=t,s(n)};return n().createElement("div",null,n().createElement(z,{label:"Style with severity"},n().createElement(l.Select,{value:c.styleWithSeverity,onChange:e=>u("styleWithSeverity",e),options:[{label:"Column",value:1},{label:"Off",value:2}]})),n().createElement(z,{label:"Severity theme"},n().createElement(l.Select,{value:c.severityTheme,onChange:e=>u("severityTheme",e),options:A})),n().createElement(K,{theme:null===(i=c.severityTheme)||void 0===i?void 0:i.value}))};function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const U=({context:e,onChange:l})=>{var a;const[r,o]=(0,t.useState)({}),i=(e,t)=>{o((n=>{const l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){H(e,t,n[t])}))}return e}({},n);return l[t]=e,l}))};return(0,t.useEffect)((()=>{l(r)}),[r]),n().createElement(n().Fragment,null,n().createElement(W,{context:e,onChange:e=>i(e,"alarmTableData")}),n().createElement(B,{context:e,onChange:e=>i(e,"alarmTablePaging")}),n().createElement($,{onChange:e=>i(e,"alarmTableAlarms"),alarmTable:null===(a=e.options)||void 0===a?void 0:a.alarmTable}))},G=new e.PanelPlugin((a=>{var o,i,c,s,u,d,m,v,f,p,b,E;const{state:x,rowClicked:O,soloIndex:j}=(e=>{const[n,l]=(0,t.useState)({indexes:[],lastClicked:-1}),[a,r]=(0,t.useState)(-1),o=e=>[...e].map((()=>!1));return{state:n,setState:l,clearIndexes:o,rowClicked:(e,t,n=!1)=>{l((l=>{let a=[...l.indexes];if(n&&a.some((e=>!0===e))||t.shiftKey&&-1!==l.lastClicked){if(!n){let{start:t,end:n}=l.lastClicked>e?{start:e,end:l.lastClicked}:{start:l.lastClicked,end:e};for(let e=t;e<=n;e++)a[e]=!0;r(-1)}}else t.ctrlKey||(a=o(a)),a[e]=!a[e],r(e),2===t.detail&&_(!0);return{indexes:a,lastClicked:e}}))},soloIndex:a}})(),{client:k}=C(null===(o=a.data)||void 0===o||null===(i=o.request)||void 0===i||null===(c=i.targets)||void 0===c||null===(s=c[0])||void 0===s?void 0:s.datasource),{filteredProps:M,page:D,setPage:z,totalPages:I}=((n,l)=>{var a,r,o;const[i,c]=(0,t.useState)((0,h.cloneDeep)(n)),[s,u]=(0,t.useState)(1),[d,m]=(0,t.useState)(0);return(0,t.useEffect)((()=>{var t,a;const r=(0,h.cloneDeep)(n),o=r.fields[0].values.length,i=Number((null===(t=l.alarmTablePaging)||void 0===t?void 0:t.rowsPerPage)||10);if(r&&(null===(a=r.meta)||void 0===a?void 0:a.entity_metadata)&&r.name&&"alarms"===r.name){var u,d;if(1===(null==l||null===(u=l.alarmTableAlarms)||void 0===u||null===(d=u.styleWithSeverity)||void 0===d?void 0:d.value)&&(r.fields=r.fields.map((e=>("Severity"===e.name&&(e.config.custom={displayMode:"color-background"}),e)))),r.fields=r.fields.filter((e=>{let t=!0;var n;return(null==l?void 0:l.alarmTableData)&&(t=!!(null===(n=null==l?void 0:l.alarmTableData.columns)||void 0===n?void 0:n.find((t=>t.label===e.name)))),t})),r.fields=r.fields.sort(((e,t)=>{var n,a,r,o;return(null==l||null===(n=l.alarmTableData)||void 0===n||null===(a=n.columns)||void 0===a?void 0:a.findIndex((t=>t.label===e.name)))-(null==l||null===(r=l.alarmTableData)||void 0===r||null===(o=r.columns)||void 0===o?void 0:o.findIndex((e=>e.label===t.name)))})),i>0&&o>i){var v;const t=s;r.fields=r.fields.map((n=>{const l=[...n.values.buffer],a=(t-1)*i,r=a+i,o=l.splice(a,r);return n.values=new e.ArrayVector(o),n})),r.length=(null===(v=r.fields[0])||void 0===v?void 0:v.values.length)||0}else r.length=o;c(r),m(Math.ceil(o/i))}}),[null==l?void 0:l.alarmTableData,s,null===(a=l.alarmTablePaging)||void 0===a?void 0:a.rowsPerPage,n,null==l||null===(r=l.alarmTableAlarms)||void 0===r?void 0:r.styleWithSeverity]),(0,t.useEffect)((()=>{var e;const t=document.querySelector(".scroll .scrollbar-view");(null==l||null===(e=l.alarmTablePaging)||void 0===e?void 0:e.scroll)?null==t||t.classList.remove("no-scroll"):null==t||t.classList.add("no-scroll")}),[null==l||null===(o=l.alarmTablePaging)||void 0===o?void 0:o.scroll]),{filteredProps:i,page:s,setPage:u,totalPages:d}})(null==a||null===(u=a.data)||void 0===u?void 0:u.series[0],null==a||null===(d=a.options)||void 0===d?void 0:d.alarmTable),{table:A,menu:L,menuOpen:q,setMenuOpen:R}=P(O),{actions:W,detailsModal:F,setDetailsModal:_}=w(x.indexes,null==a||null===(m=a.data)||void 0===m||null===(v=m.series)||void 0===v?void 0:v[0].fields,(()=>R(!1)),k),{tabActive:B,tabClick:V,resetTabs:K}=(()=>{const[e,n]=(0,t.useState)(0);return{tabActive:e,tabClick:e=>{n(e)},resetTabs:()=>{n(0)}}})(),{alarm:J,goToAlarm:$,alarmQuery:H}=N(null==a||null===(f=a.data)||void 0===f?void 0:f.series,j,k);return((e,n)=>{(0,t.useEffect)((()=>{var t;const l=null===(t=n.current)||void 0===t?void 0:t.querySelectorAll('.table-body div[role="row"]');l&&l.forEach(((t,n)=>{t.classList.remove("select-start"),t.classList.remove("select-continue"),t.classList.remove("select-end"),!e.indexes[n-1]&&e.indexes[n]&&t.classList.add("select-start"),e.indexes[n-1]&&e.indexes[n]&&e.indexes[n+1]&&t.classList.add("select-continue"),e.indexes[n]&&!e.indexes[n+1]&&t.classList.add("select-end")}))}))})(x,A),((n,l,a)=>{var r,o;const i=(null===(r=null==a?void 0:a.alarmTable.alarmTableAlarms)||void 0===r||null===(o=r.severityTheme)||void 0===o?void 0:o.value)||0;(0,t.useEffect)((()=>{const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){S(e,t,n[t])}))}return e}({},n);5!==i&&(t.defaults.mappings=[{type:e.MappingType.ValueToText,options:{INDETERMINATE:{color:T[i][0],index:0,text:"Indeterminate"}}},{type:e.MappingType.ValueToText,options:{CLEARED:{color:T[i][1],index:1,text:"Cleared"}}},{type:e.MappingType.ValueToText,options:{NORMAL:{color:T[i][2],index:2,text:"Normal"}}},{type:e.MappingType.ValueToText,options:{WARNING:{color:T[i][3],index:3,text:"Warning"}}},{type:e.MappingType.ValueToText,options:{MINOR:{color:T[i][4],index:4,text:"Minor"}}},{type:e.MappingType.ValueToText,options:{MAJOR:{color:T[i][5],index:5,text:"Major"}}},{type:e.MappingType.ValueToText,options:{CRITICAL:{color:T[i][6],index:6,text:"Critical"}}}],l(t))}),[i])})(a.fieldConfig,a.onFieldConfigChange,a.options),n().createElement("div",{ref:A,className:`\n            ${H?"alarm-query":"non-alarm-query"}\n            ${(null===(p=a.options)||void 0===p||null===(b=p.alarmTable)||void 0===b||null===(E=b.alarmTablePaging)||void 0===E?void 0:E.scroll)?"scroll":"no-scroll"}\n            ${(()=>{var e,t;return`font-size-${null===(e=null===(t=a.options)||void 0===t?void 0:t.alarmTable.alarmTablePaging.fontSize)||void 0===e?void 0:e.value}`})()}\n            `},n().createElement(g,null),n().createElement("div",{style:{height:"90%"}},H?n().createElement(l.Table,{data:M,width:a.width,height:a.height}):n().createElement("div",null,"Select the Entity Datasource below, and choose an Alarm query to see results.")),n().createElement("div",{style:{width:"100%",height:"10%"}},n().createElement("div",null,n().createElement(l.Pagination,{numberOfPages:I===1/0?0:I,currentPage:D,onNavigate:e=>{z(e)},hideWhenSinglePage:!0}))),q&&n().createElement(l.ContextMenu,{x:L.x,y:L.y,onClose:()=>{K(),R(!1)},renderMenuItems:()=>n().createElement(r,{state:x,actions:W})}),n().createElement(l.Modal,{isOpen:F,title:"Alarm Detail",onDismiss:()=>_(!1)},n().createElement(l.Button,{style:{marginBottom:12},onClick:$},n().createElement("i",{className:"fa fa-external-link"})," Full Details"),n().createElement(l.TabsBar,null,n().createElement(l.Tab,{label:"Overview",active:0===B,onChangeTab:()=>V(0)}),n().createElement(l.Tab,{label:"Memos",active:1===B,onChangeTab:()=>V(1)}),n().createElement(l.Tab,{label:"JSON",active:2===B,onChangeTab:()=>V(2)})),n().createElement(l.TabContent,null,n().createElement(y,{tab:B,alarm:J,client:k}))))}));G.useFieldConfig(),G.setPanelOptions((e=>{e.addCustomEditor({id:"alarm-table-options",path:"alarmTable",name:"",editor:U})}))})(),s})()));
//# sourceMappingURL=module.js.map