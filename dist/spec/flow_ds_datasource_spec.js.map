{"version":3,"sources":["../../src/spec/flow_ds_datasource_spec.js"],"names":["FlowDatasource","describe","flowSeriesExample","it","done","actualResponse","toSeries","expectedResponse","expect","to","eql","target"],"mappings":"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","file":"flow_ds_datasource_spec.js","sourcesContent":["import {FlowDatasource} from '../datasources/flow-ds/datasource';\n\ndescribe(\"OpenNMS_Flow_Datasource\", function () {\n\n  let flowSeriesExample = {\n    \"start\": 1516358909932,\n    \"end\": 1516373309932,\n    \"columns\": [\n      {\n        \"label\": \"domain\",\n        \"ingress\": true\n      },\n      {\n        \"label\": \"domain\",\n        \"ingress\": false\n      }\n    ],\n    \"timestamps\": [\n      1516358909932\n    ],\n    \"values\": [\n      [\n        1\n      ],\n      [\n        2\n      ]\n    ]\n  };\n\n  describe('Mapping', function () {\n    it(\"should map series response to Grafana series\", function (done) {\n      let actualResponse = FlowDatasource.toSeries({}, flowSeriesExample);\n      let expectedResponse = [\n        {\n          \"datapoints\": [\n            [\n              1,\n              1516358909932\n            ]\n          ],\n          \"target\": \"domain (In)\"\n        },\n        {\n          \"datapoints\": [\n            [\n              2,\n              1516358909932\n            ]\n          ],\n          \"target\": \"domain (Out)\"\n        }\n      ];\n\n      expect(expectedResponse).to.eql(actualResponse);\n      done();\n    });\n\n\n    it(\"should combine ingress and egress when set\", function (done) {\n      let target = {\n        'functions': [\n          {\n            'name': 'combineIngressEgress'\n          }\n        ]\n      };\n      let actualResponse = FlowDatasource.toSeries(target, flowSeriesExample);\n      let expectedResponse = [\n        {\n          \"datapoints\": [\n            [\n              3,\n              1516358909932\n            ]\n          ],\n          \"target\": \"domain\"\n        }\n      ];\n\n      expect(expectedResponse).to.eql(actualResponse);\n      done();\n    });\n\n    it(\"should convert bytes to bits when set\", function (done) {\n      let target = {\n        'functions': [\n          {\n            'name': 'toBits'\n          }\n        ]\n      };\n      let actualResponse = FlowDatasource.toSeries(target, flowSeriesExample);\n      let expectedResponse = [\n        {\n          \"datapoints\": [\n            [\n              8,\n              1516358909932\n            ]\n          ],\n          \"target\": \"domain (In)\"\n        },\n        {\n          \"datapoints\": [\n            [\n              16,\n              1516358909932\n            ]\n          ],\n          \"target\": \"domain (Out)\"\n        }\n      ];\n\n      expect(expectedResponse).to.eql(actualResponse);\n      done();\n    });\n\n    it(\"should only show ingress when set\", function (done) {\n      let target = {\n        'functions': [\n          {\n            'name': 'onlyIngress'\n          }\n        ]\n      };\n      let actualResponse = FlowDatasource.toSeries(target, flowSeriesExample);\n      let expectedResponse = [\n        {\n          \"datapoints\": [\n            [\n              1,\n              1516358909932\n            ]\n          ],\n          \"target\": \"domain (In)\"\n        }\n      ];\n\n      expect(expectedResponse).to.eql(actualResponse);\n      done();\n    });\n\n    it(\"should only show egress when set\", function (done) {\n      let target = {\n        'functions': [\n          {\n            'name': 'onlyEgress'\n          }\n        ]\n      };\n      let actualResponse = FlowDatasource.toSeries(target, flowSeriesExample);\n      let expectedResponse = [\n        {\n          \"datapoints\": [\n            [\n              2,\n              1516358909932\n            ]\n          ],\n          \"target\": \"domain (Out)\"\n        }\n      ];\n\n      expect(expectedResponse).to.eql(actualResponse);\n      done();\n    });\n  });\n\n});\n"]}