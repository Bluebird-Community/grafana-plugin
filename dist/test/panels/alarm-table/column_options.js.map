{"version":3,"sources":["../../../../src/panels/alarm-table/column_options.js"],"names":["columnOptionsTab","ColumnOptionsCtrl","$scope","$q","uiSegmentSrv","editor","activeStyleIndex","panelCtrl","ctrl","panel","unitFormats","getUnitFormats","colorModes","text","value","columnTypes","fontSizes","dateFormats","getColumnNames","table","map","columns","col","render","column","subItem","unit","newStyleRule","type","alias","decimals","colors","colorMode","pattern","dateFormat","thresholds","width","clip","styles","stylesCount","length","indexToInsert","last","splice","style","without","index","ref","copy","restrict","scope","templateUrl","controller"],"mappings":"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","file":"column_options.js","sourcesContent":["import _ from 'lodash';\n\nimport kbn from 'app/core/utils/kbn';\n\nexport class ColumnOptionsCtrl {\n  /** @ngInject */\n  constructor($scope, $q, uiSegmentSrv) {\n    this.$q = $q;\n    this.uiSegmentSrv = uiSegmentSrv;\n    $scope.editor = this;\n    this.activeStyleIndex = 0;\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n    this.unitFormats = kbn.getUnitFormats();\n    this.colorModes = [\n      {text: 'Disabled', value: null},\n      {text: 'Cell', value: 'cell'},\n      {text: 'Value', value: 'value'},\n      {text: 'Row', value: 'row'},\n    ];\n    this.columnTypes = [\n      {text: 'Number', value: 'number'},\n      {text: 'String', value: 'string'},\n      {text: 'Date', value: 'date'},\n      {text: 'Severity', value:'severity'},\n      {text: 'Hidden', value: 'hidden'}\n    ];\n    this.fontSizes = ['80%', '90%', '100%', '110%', '120%', '130%', '150%', '160%', '180%', '200%', '220%', '250%'];\n    this.dateFormats = [\n      {text: 'DD MMM HH:mm:ss', value: 'DD MMM HH:mm:ss'},\n      {text: 'YYYY-MM-DD HH:mm:ss', value: 'YYYY-MM-DD HH:mm:ss'},\n      {text: 'MM/DD/YY h:mm:ss a', value: 'MM/DD/YY h:mm:ss a'},\n      {text: 'MMMM D, YYYY LT', value: 'MMMM D, YYYY LT'},\n      {text: 'relative', value: 'relative'},\n      {text: 'relative (short)', value: 'relative-short'}\n    ];\n\n    this.getColumnNames = () => {\n      if (!this.panelCtrl.table) {\n        return [];\n      }\n      return _.map(this.panelCtrl.table.columns, function (col) {\n        return col.text;\n      });\n    };\n  }\n\n  render() {\n    this.panelCtrl.render();\n  }\n\n  setUnitFormat(column, subItem) {\n    column.unit = subItem.value;\n    this.panelCtrl.render();\n  }\n\n  addColumnStyle() {\n    let newStyleRule = {\n      unit: 'short',\n      type: 'number',\n      alias: '',\n      decimals: 2,\n      colors: [\"rgba(245, 54, 54, 0.9)\", \"rgba(237, 129, 40, 0.89)\", \"rgba(50, 172, 45, 0.97)\"],\n      colorMode: null,\n      pattern: '',\n      dateFormat: 'YYYY-MM-DD HH:mm:ss',\n      thresholds: [],\n      width: \"\",\n      clip: false\n    };\n\n    let styles = this.panel.styles;\n    let stylesCount = styles.length;\n    let indexToInsert = stylesCount;\n\n    // check if last is a catch all rule, then add it before that one\n    if (stylesCount > 0) {\n      let last = styles[stylesCount - 1];\n      if (last.pattern === '/.*/') {\n        indexToInsert = stylesCount - 1;\n      }\n    }\n\n    styles.splice(indexToInsert, 0, newStyleRule);\n    this.activeStyleIndex = indexToInsert;\n  }\n\n  removeColumnStyle(style) {\n    this.panel.styles = _.without(this.panel.styles, style);\n  }\n\n  invertColorOrder(index) {\n    let ref = this.panel.styles[index].colors;\n    let copy = ref[0];\n    ref[0] = ref[2];\n    ref[2] = copy;\n    this.panelCtrl.render();\n  }\n}\n\n/** @ngInject */\nexport function columnOptionsTab($q, uiSegmentSrv) { // eslint-disable-line no-unused-vars\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/plugins/opennms-helm-app/panels/alarm-table/column_options.html',\n    controller: ColumnOptionsCtrl,\n  };\n}\n"]}