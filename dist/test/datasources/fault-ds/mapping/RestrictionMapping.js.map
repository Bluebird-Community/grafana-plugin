{"version":3,"sources":["../../../../../src/datasources/fault-ds/mapping/RestrictionMapping.js"],"names":["RestrictionMapping","uiSegmentSrv","apiRestriction","NestedRestriction","getUiQuery","uiRestriction","Restriction","RestrictionDTO","getUiAttribute","attribute","getUiComparator","comparator","getUiValue","value","apiNestedRestriction","self","uiQuery","Query","uiClauses","map","clauses","getUiClause","clause","each","addClause","uiClause","getApiNestedRestriction","restrictionDTO","asRestrictionDTO","getApiAttribute","getApiComparator","getApiValue","nestedRestriction","apiClause","getApiClause","withClause"],"mappings":";;;;;;;;;AAAA;;;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;IAEaA,kB,WAAAA,kB;AAET,gCAAYC,YAAZ,EAA0B;AAAA;;AACtB,aAAKA,YAAL,GAAoBA,YAApB;AACH;;;;yCAEgBC,c,EAAgB;AAC7B,gBAAIA,0BAA0B,aAAIC,iBAAlC,EAAqD;AACjD,uBAAO,KAAKC,UAAL,CAAgBF,cAAhB,CAAP;AACH,aAFD,MAEO;AACH,oBAAIG,gBAAgB,IAAI,OAAGC,WAAP,CAChB,KAAKL,YADW,EAEhB,IAAI,OAAGM,cAAP,CACI,yCAAuBC,cAAvB,CAAsCN,eAAeO,SAArD,CADJ,EAEI,2CAAwBC,eAAxB,CAAwCR,eAAeS,UAAvD,CAFJ,EAGI,iCAAmBC,UAAnB,CAA8BV,eAAeO,SAA7C,EAAwDP,eAAeW,KAAvE,CAHJ,CAFgB,CAApB;AAQA,uBAAOR,aAAP;AACH;AACJ;;;mCAEUS,oB,EAAsB;AAC7B,gBAAIC,OAAO,IAAX;AACA,gBAAIC,UAAU,IAAI,OAAGC,KAAP,CAAa,KAAKhB,YAAlB,CAAd;AACA,gBAAIiB,YAAY,iBAAEC,GAAF,CAAML,qBAAqBM,OAA3B,EAAoC,kBAAU;AAC1D,uBAAO,iCAAkBL,KAAKd,YAAvB,EAAqCoB,WAArC,CAAiDC,MAAjD,CAAP;AACH,aAFe,CAAhB;AAGA,6BAAEC,IAAF,CAAOL,SAAP,EAAkB,oBAAY;AAC1BF,wBAAQQ,SAAR,CAAkBC,QAAlB;AACH,aAFD;AAGA,mBAAOT,OAAP;AACH;;;0CAEiBX,a,EAAe;AAC7B,gBAAIA,yBAAyB,OAAGY,KAAhC,EAAuC;AACnC,uBAAO,KAAKS,uBAAL,CAA6BrB,aAA7B,CAAP;AACH,aAFD,MAEO;AACH,oBAAMsB,iBAAiBtB,cAAcuB,gBAAd,EAAvB;AACA,oBAAID,mBAAmB,IAAvB,EAA6B;AACzB,wBAAMlB,YAAY,yCAAuBoB,eAAvB,CAAuCF,eAAelB,SAAtD,CAAlB;AACA,wBAAME,aAAa,2CAAwBmB,gBAAxB,CAAyCH,eAAehB,UAAxD,CAAnB;AACA,wBAAME,QAAQ,iCAAmBkB,WAAnB,CAA+BJ,eAAelB,SAA9C,EAAyDkB,eAAed,KAAxE,CAAd;AACA,2BAAO,IAAI,aAAIP,WAAR,CAAoBG,SAApB,EAA+BE,UAA/B,EAA2CE,KAA3C,CAAP;AACH;AACD,uBAAO,IAAP;AACH;AACJ;;;gDAEuBG,O,EAAS;AAC7B,gBAAMD,OAAO,IAAb;AACA,gBAAMiB,oBAAoB,IAAI,aAAI7B,iBAAR,EAA1B;AACA,6BAAEoB,IAAF,CAAOP,QAAQI,OAAf,EAAwB,oBAAY;AAChC,oBAAMa,YAAY,iCAAkBlB,KAAKd,YAAvB,EAAqCiC,YAArC,CAAkDT,QAAlD,CAAlB;AACA,oBAAIQ,cAAc,IAAlB,EAAwB;AACpBD,sCAAkBG,UAAlB,CAA6BF,SAA7B;AACH;AACJ,aALD;AAMA,mBAAOD,iBAAP;AACH","file":"RestrictionMapping.js","sourcesContent":["import _ from 'lodash';\n\nimport {ComparatorMapping} from './ComparatorMapping'\nimport {ClauseMapping} from './ClauseMapping'\nimport {AttributeMapping} from './AttributeMapping';\nimport {ValueMapping} from './ValueMapping';\nimport {UI} from '../UI'\nimport {API} from '../../../opennms';\n\nexport class RestrictionMapping {\n\n    constructor(uiSegmentSrv) {\n        this.uiSegmentSrv = uiSegmentSrv;\n    }\n\n    getUiRestriction(apiRestriction) {\n        if (apiRestriction instanceof API.NestedRestriction) {\n            return this.getUiQuery(apiRestriction);\n        } else {\n            var uiRestriction = new UI.Restriction(\n                this.uiSegmentSrv,\n                new UI.RestrictionDTO(\n                    new AttributeMapping().getUiAttribute(apiRestriction.attribute),\n                    new ComparatorMapping().getUiComparator(apiRestriction.comparator),\n                    new ValueMapping().getUiValue(apiRestriction.attribute, apiRestriction.value)\n                )\n            );\n            return uiRestriction\n        }\n    }\n\n    getUiQuery(apiNestedRestriction) {\n        let self = this;\n        let uiQuery = new UI.Query(this.uiSegmentSrv);\n        var uiClauses = _.map(apiNestedRestriction.clauses, clause => {\n            return new ClauseMapping(self.uiSegmentSrv).getUiClause(clause);\n        });\n        _.each(uiClauses, uiClause => {\n            uiQuery.addClause(uiClause);\n        });\n        return uiQuery;\n    }\n\n    getApiRestriction(uiRestriction) {\n        if (uiRestriction instanceof UI.Query) {\n            return this.getApiNestedRestriction(uiRestriction);\n        } else {\n            const restrictionDTO = uiRestriction.asRestrictionDTO();\n            if (restrictionDTO !== null) {\n                const attribute = new AttributeMapping().getApiAttribute(restrictionDTO.attribute);\n                const comparator = new ComparatorMapping().getApiComparator(restrictionDTO.comparator);\n                const value = new ValueMapping().getApiValue(restrictionDTO.attribute, restrictionDTO.value);\n                return new API.Restriction(attribute, comparator, value);\n            }\n            return null;\n        }\n    }\n\n    getApiNestedRestriction(uiQuery) {\n        const self = this;\n        const nestedRestriction = new API.NestedRestriction();\n        _.each(uiQuery.clauses, uiClause => {\n            const apiClause = new ClauseMapping(self.uiSegmentSrv).getApiClause(uiClause);\n            if (apiClause !== null) {\n                nestedRestriction.withClause(apiClause);\n            }\n        });\n        return nestedRestriction;\n    }\n}"]}