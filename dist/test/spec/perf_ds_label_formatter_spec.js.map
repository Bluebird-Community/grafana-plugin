{"version":3,"sources":["../../../src/spec/perf_ds_label_formatter_spec.js"],"names":["FUNCS","exclamationer","arg","insulter","person","insult","describe","it","found","findFunctions","expect","to","exist","length","equal","deep","name","arguments","res","replace","simpleFunction","metadata","format"],"mappings":"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","file":"perf_ds_label_formatter_spec.js","sourcesContent":["import {FunctionFormatter} from \"../datasources/perf-ds/function_formatter\";\n\nconst FUNCS = {\n    exclamationer: (arg) => {\n        return arg + '!!!';\n    },\n    insulter: (person, insult) => {\n        return person + ' is a total ' + insult + '!';\n    }\n};\n\ndescribe('OpenNMSPMDatasource :: LabelFormatter', () => {\n    describe('findFunctions()', () => {\n        it('find a simple function with no arguments', () => {\n            const found = FunctionFormatter.findFunctions('simpleFunction()');\n            expect(found).to.exist;\n            expect(found.length).to.equal(1);\n            expect(found).to.deep.equal([\n                {\n                    name: 'simpleFunction',\n                    arguments: []\n                }\n            ]);\n        });\n        it('find a simple function with one argument', () => {\n            const found = FunctionFormatter.findFunctions('simpleFunction(foo)');\n            expect(found).to.exist;\n            expect(found.length).to.equal(1);\n            expect(found).to.deep.equal([\n                {\n                    name: 'simpleFunction',\n                    arguments: ['foo']\n                }\n            ]);\n        });\n        it('find a simple function with many arguments', () => {\n            const found = FunctionFormatter.findFunctions('simpleFunction(foo, bar, baz)');\n            expect(found).to.exist;\n            expect(found.length).to.equal(1);\n            expect(found).to.deep.equal([\n                {\n                    name: 'simpleFunction',\n                    arguments: ['foo', 'bar', 'baz']\n                }\n            ]);\n        });\n        it('find multiple functions with arguments', () => {\n            const found = FunctionFormatter.findFunctions('simpleFunction(foo, bar, baz), anotherThing($nodes)');\n            expect(found).to.exist;\n            expect(found.length).to.equal(2);\n            expect(found).to.deep.equal([\n                {\n                    name: 'simpleFunction',\n                    arguments: ['foo', 'bar', 'baz']\n                },\n                {\n                    name: 'anotherThing',\n                    arguments: ['$nodes']\n                }\n            ]);\n        });\n    });\n\n    describe('replace()', () => {\n        it('do not replace an unmatched function', () => {\n            const res = FunctionFormatter.replace('unmatchedFunction()', {\n                simpleFunction: () => {\n                    return 'foo';\n                }\n            });\n            expect(res).to.equal('unmatchedFunction()');\n        });\n        it('replace a simple function without arguments', () => {\n            const res = FunctionFormatter.replace('simpleFunction()', {\n                simpleFunction: () => {\n                    return 'foo';\n                }\n            });\n            expect(res).to.equal('foo');\n        });\n        it('replace a simple function with an argument', () => {\n            const res = FunctionFormatter.replace('exclamationer(foo)', FUNCS);\n            expect(res).to.equal('foo!!!');\n        });\n        it('replace a simple function with multiple arguments', () => {\n            const res = FunctionFormatter.replace('insulter(Bob, jerk)', FUNCS);\n            expect(res).to.equal('Bob is a total jerk!');\n        });\n        it('replace multiple functions', () => {\n            const res = FunctionFormatter.replace('exclamationer(Hey)  insulter(Bob, jerk)', FUNCS);\n            expect(res).to.equal('Hey!!!  Bob is a total jerk!');\n        });\n    });\n\n    const metadata = {\n        \"resources\": [\n            {\n                \"id\": \"node[situation-test:nodea].responseTime[127.0.0.1]\",\n                \"label\": \"127.0.0.1\",\n                \"name\": \"localhost\",\n                \"parent-id\": \"node[situation-test:nodea]\",\n                \"node-id\": 1\n            },\n            {\n                \"id\": \"node[situation-test:nodeb].responseTime[127.0.0.1]\",\n                \"label\": \"127.0.0.1\",\n                \"name\": \"localhost\",\n                \"parent-id\": \"node[situation-test:nodeb]\",\n                \"node-id\": 2\n            },\n            {\n                \"id\": \"node[situation-test:nodeb].interfaceSnmp[en0-000123456789]\",\n                \"label\": \"en0 (127.0.0.1, 304.2 Mbps)\",\n                \"name\": \"en0-000123456789\",\n                \"parent-id\": \"node[situation-test:nodeb]\",\n                \"node-id\": 2\n            }\n        ],\n        \"nodes\": [\n            {\n                \"id\": 1,\n                \"label\": \"ThisIsAVeryLongNodeLabel1\",\n                \"foreign-source\": \"situation-test\",\n                \"foreign-id\": \"nodea\"\n            },\n            {\n                \"id\": 2,\n                \"label\": \"ThisIsAVeryLongNodeLabel2\",\n                \"foreign-source\": \"situation-test\",\n                \"foreign-id\": \"nodeb\"\n            }\n        ]\n    };\n\n    describe('format()', () => {\n        it('nodeToLabel(foreignSource:foreignId)', () => {\n            const res = FunctionFormatter.format('nodeToLabel(situation-test:nodea)', metadata);\n            expect(res).to.equal('ThisIsAVeryLongNodeLabel1');\n        });\n        it('nodeToLabel(nodeId)', () => {\n            const res = FunctionFormatter.format('nodeToLabel(1)', metadata);\n            expect(res).to.equal('ThisIsAVeryLongNodeLabel1');\n        });\n        it('nodeToLabel(invalid)', () => {\n            const res = FunctionFormatter.format('nodeToLabel(3)', metadata);\n            expect(res).to.equal('3');\n        });\n\n        it('resourceToLabel(resourceId)', () => {\n            const res = FunctionFormatter.format('resourceToLabel(node[situation-test:nodea].responseTime[127.0.0.1])', metadata);\n            expect(res).to.equal('127.0.0.1');\n        });\n        it('resourceToLabel(situation-test:nodea, responseTime[127.0.0.1])', () => {\n            const res = FunctionFormatter.format('resourceToLabel(situation-test:nodea, responseTime[127.0.0.1])', metadata);\n            expect(res).to.equal('127.0.0.1');\n        });\n        it('resourceToLabel(invalid)', () => {\n            const res = FunctionFormatter.format('resourceToLabel(foo)', metadata);\n            expect(res).to.equal('foo');\n        });\n        it('resourceToLabel(invalid, invalid)', () => {\n            const res = FunctionFormatter.format('resourceToLabel(foo, bar)', metadata);\n            expect(res).to.equal('foo.bar');\n        });\n\n        it('resourceToName(resourceId)', () => {\n            const res = FunctionFormatter.format('resourceToName(node[situation-test:nodea].responseTime[127.0.0.1])', metadata);\n            expect(res).to.equal('localhost');\n        });\n        it('resourceToName(situation-test:nodea, responseTime[127.0.0.1])', () => {\n            const res = FunctionFormatter.format('resourceToName(situation-test:nodea, responseTime[127.0.0.1])', metadata);\n            expect(res).to.equal('localhost');\n        });\n        it('resourceToName(invalid)', () => {\n            const res = FunctionFormatter.format('resourceToName(foo)', metadata);\n            expect(res).to.equal('foo');\n        });\n        it('resourceToName(invalid, invalid)', () => {\n            const res = FunctionFormatter.format('resourceToName(foo, bar)', metadata);\n            expect(res).to.equal('foo.bar');\n        });\n\n        it('resourceToInterface(resourceId)', () => {\n            const res = FunctionFormatter.format('resourceToInterface(node[situation-test:nodeb].interfaceSnmp[en0-000123456789])', metadata);\n            expect(res).to.equal('en0');\n        });\n        it('resourceToInterface(situation-test:nodeb, interfaceSnmp[en0-000123456789])', () => {\n            const res = FunctionFormatter.format('resourceToInterface(situation-test:nodeb, interfaceSnmp[en0-000123456789])', metadata);\n            expect(res).to.equal('en0');\n        });\n        it('resourceToInterface(invalid)', () => {\n            const res = FunctionFormatter.format('resourceToInterface(foo)', metadata);\n            expect(res).to.equal('foo');\n        });\n        it('resourceToInterface(invalid, invalid)', () => {\n            const res = FunctionFormatter.format('resourceToInterface(foo, bar)', metadata);\n            expect(res).to.equal('foo.bar');\n        });\n    });\n});\n"]}